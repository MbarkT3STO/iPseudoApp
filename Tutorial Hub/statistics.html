<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Statistics | iPseudo Tutorial Hub</title>
    <link rel="icon" type="image/svg+xml" href="assets/app-icon.svg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#9333ea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="iPseudo">
    <link rel="apple-touch-icon" href="assets/app-icon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/tutorial.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <style>
        /* Statistics Page Modern Enhancements */
        
        /* Modern Navbar Styles */
        .navbar {
            backdrop-filter: blur(12px) saturate(180%) !important;
            -webkit-backdrop-filter: blur(12px) saturate(180%) !important;
            background: rgba(15, 23, 42, 0.7) !important;
            border-bottom: 1px solid rgba(147, 51, 234, 0.2);
        }
        
        [data-theme="light"] .navbar {
            background: rgba(255, 255, 255, 0.7) !important;
            border-bottom: 1px solid rgba(147, 51, 234, 0.15);
        }
        
        .navbar-actions {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .nav-btn-primary,
        .nav-btn-secondary,
        .nav-btn-action {
            padding: 0.625rem 1.125rem;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.9375rem;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
        }
        
        .nav-btn-primary {
            color: var(--text-primary);
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.2);
        }
        
        .nav-btn-primary:hover {
            background: rgba(147, 51, 234, 0.2);
            border-color: rgba(147, 51, 234, 0.4);
            transform: translateY(-2px);
        }
        
        .nav-btn-secondary {
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid transparent;
        }
        
        .nav-btn-secondary:hover {
            color: var(--text-primary);
            background: rgba(147, 51, 234, 0.1);
            border-color: rgba(147, 51, 234, 0.2);
        }
        
        .nav-btn-action {
            background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500));
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(147, 51, 234, 0.3);
        }
        
        .nav-btn-action:hover {
            box-shadow: 0 6px 20px rgba(147, 51, 234, 0.4);
            transform: translateY(-2px);
        }
        
        .nav-divider {
            width: 1px;
            height: 24px;
            background: rgba(147, 51, 234, 0.2);
            margin: 0 0.25rem;
        }
        
        /* Background - Disabled for performance */
        .background-container .gradient-orb,
        .background-container .grid-pattern {
            display: none !important;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--color-purple-500), var(--color-blue-500));
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--color-purple-600), var(--color-blue-600));
        }
        
        /* Selection highlight */
        ::selection {
            background: rgba(147, 51, 234, 0.3);
            color: var(--text-primary);
        }
        
        /* Stat Cards - No glassmorphism */
        .stat-card {
            background: rgba(147, 51, 234, 0.05) !important;
            border: 1px solid rgba(147, 51, 234, 0.1) !important;
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        [data-theme="light"] .stat-card {
            background: rgba(147, 51, 234, 0.03) !important;
            border-color: rgba(147, 51, 234, 0.15) !important;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(147, 51, 234, 0.15);
            border-color: rgba(147, 51, 234, 0.3) !important;
        }
        
        /* Chart containers - No glassmorphism */
        div[style*="background: var(--glass-bg)"] {
            background: rgba(147, 51, 234, 0.05) !important;
            border: 1px solid rgba(147, 51, 234, 0.1) !important;
            backdrop-filter: none !important;
        }
        
        [data-theme="light"] div[style*="background: var(--glass-bg)"] {
            background: rgba(147, 51, 234, 0.03) !important;
            border-color: rgba(147, 51, 234, 0.15) !important;
        }
        
        @media (max-width: 768px) {
            .navbar-actions {
                gap: 0.375rem !important;
            }
            
            .nav-btn-primary,
            .nav-btn-secondary,
            .nav-btn-action {
                padding: 0.5rem 0.875rem !important;
                font-size: 0.875rem !important;
            }
            
            .nav-btn-secondary span,
            .nav-btn-primary span {
                display: none;
            }
            
            .nav-divider {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="background-container">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="grid-pattern"></div>
    </div>

    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="index.html" style="display: flex; align-items: center; text-decoration: none; gap: 0.75rem;">
                    <div class="brand-icon" style="background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500)); padding: 0.5rem; border-radius: 10px;">
                        <i class="ri-book-open-line" style="color: white; font-size: 1.5rem;"></i>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.1rem;">
                        <span class="brand-text" style="font-size: 1.25rem; font-weight: 700; background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">iPseudo</span>
                        <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: 600; letter-spacing: 0.05em;">TUTORIAL HUB</span>
                    </div>
                </a>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="ri-sun-line theme-icon" id="lightIcon"></i>
                    <i class="ri-moon-line theme-icon hidden" id="darkIcon"></i>
                </button>
            </div>

            <div class="navbar-actions">
                <!-- Learning Section -->
                <a href="index.html" class="nav-btn-primary">
                    <i class="ri-book-open-line"></i>
                    <span>Lessons</span>
                </a>
                <a href="Exercises/exercises-index.html" class="nav-btn-primary">
                    <i class="ri-trophy-line"></i>
                    <span>Exercises</span>
                </a>
                
                <!-- Divider -->
                <div class="nav-divider"></div>
                
                <!-- Tools Section -->
                <a href="dashboard/index.html" class="nav-btn-secondary">
                    <i class="ri-dashboard-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="statistics.html" class="nav-btn-secondary">
                    <i class="ri-bar-chart-line"></i>
                    <span>Stats</span>
                </a>
                <a href="my-notes.html" class="nav-btn-secondary">
                    <i class="ri-sticky-note-line"></i>
                    <span>Notes</span>
                </a>
                
                <!-- Divider -->
                <div class="nav-divider"></div>
                
                <!-- Action Button -->
                <a href="https://ipseudoeditor.netlify.app/" target="_blank" class="nav-btn-action">
                    <i class="ri-play-circle-fill"></i>
                    <span>Try Live Editor</span>
                </a>
            </div>
        </div>
    </nav>

    <section class="tutorial-content">
        <div class="tutorial-container" style="max-width: 1200px;">
            <div class="tutorial-header" style="text-align: center; margin-bottom: var(--space-2xl);">
                <div style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1.25rem; background: linear-gradient(135deg, rgba(147, 51, 234, 0.15), rgba(59, 130, 246, 0.15)); border: 1px solid rgba(147, 51, 234, 0.3); border-radius: 50px; font-size: 0.875rem; font-weight: 600; color: var(--color-purple-500); margin-bottom: var(--space-md);">
                    <i class="ri-bar-chart-box-line"></i>
                    <span>Learning Analytics</span>
                </div>
                <h1 class="tutorial-title">My Statistics</h1>
                <p style="color: var(--text-secondary); font-size: 1.125rem; margin-top: var(--space-md);">
                    Track your learning journey and celebrate your achievements
                </p>
            </div>

            <!-- Overall Progress Card -->
            <div id="overallProgress" style="margin-bottom: var(--space-2xl);"></div>

            <!-- Stats Grid -->
            <div class="stats-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-lg); margin-bottom: var(--space-2xl);">
                <div id="totalLessons" class="stat-card"></div>
                <div id="completedLessons" class="stat-card"></div>
                <div id="inProgressLessons" class="stat-card"></div>
                <div id="achievementsCount" class="stat-card"></div>
            </div>

            <!-- Detailed Progress Charts -->
            <div style="margin-bottom: var(--space-2xl);">
                <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-lg); text-align: center;">
                    <i class="ri-line-chart-line" style="color: var(--color-purple-500);"></i>
                    Progress Analytics
                </h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: var(--space-lg); margin-bottom: var(--space-lg);">
                    <!-- Completion Progress Over Time -->
                    <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-xl); padding: var(--space-xl); backdrop-filter: blur(10px);">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 0.5rem;">
                            <i class="ri-line-chart-line" style="color: var(--color-purple-500);"></i>
                            Completion Progress
                        </h3>
                        <canvas id="progressChart" style="max-height: 300px;"></canvas>
                    </div>

                    <!-- Category Breakdown -->
                    <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-xl); padding: var(--space-xl); backdrop-filter: blur(10px);">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 0.5rem;">
                            <i class="ri-pie-chart-line" style="color: var(--color-blue-500);"></i>
                            Category Breakdown
                        </h3>
                        <canvas id="categoryChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>

                <!-- Weekly Activity & Study Time -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: var(--space-lg);">
                    <!-- Weekly Activity -->
                    <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-xl); padding: var(--space-xl); backdrop-filter: blur(10px);">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-lg); display: flex; align-items: center; gap: 0.5rem;">
                            <i class="ri-calendar-line" style="color: var(--color-success);"></i>
                            Weekly Activity
                        </h3>
                        <canvas id="weeklyChart" style="max-height: 300px;"></canvas>
                    </div>

                    <!-- Estimated Time to Completion -->
                    <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-xl); padding: var(--space-xl); backdrop-filter: blur(10px);">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 0.5rem;">
                            <i class="ri-time-line" style="color: var(--color-orange-600);"></i>
                            Study Insights
                        </h3>
                        <div id="studyInsights" style="display: flex; flex-direction: column; gap: var(--space-lg);"></div>
                    </div>
                </div>
            </div>

            <!-- Level Breakdown -->
            <div style="margin-bottom: var(--space-2xl);">
                <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-lg); text-align: center;">
                    Progress by Level
                </h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: var(--space-lg);">
                    <div id="beginnerProgress"></div>
                    <div id="intermediateProgress"></div>
                    <div id="advancedProgress"></div>
                </div>
            </div>

            <!-- Achievements Section -->
            <div id="achievementsSection" style="margin-bottom: var(--space-2xl);"></div>

            <!-- Recent Activity -->
            <div id="recentActivity"></div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="brand-icon">
                        <i class="ri-code-s-slash-line"></i>
                    </div>
                    <span class="brand-name">iPseudo IDE</span>
                    <p class="footer-tagline">Making pseudocode beautiful</p>
                </div>
                
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>Tutorial</h4>
                        <ul>
                            <li><a href="index.html">All Lessons</a></li>
                            <li><a href="01-introduction-to-pseudocode.html">Getting Started</a></li>
                            <li><a href="03-variables-and-data-types.html">Variables</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-column">
                        <h4>Exercises</h4>
                        <ul>
                            <li><a href="Exercises/exercises-index.html">Exercise Hub</a></li>
                            <li><a href="Exercises/exercises-variables.html">Variables & Data Types</a></li>
                            <li><a href="Exercises/exercises-operators.html">Operators</a></li>
                            <li><a href="Exercises/exercises-conditionals.html">Conditionals</a></li>
                            <li><a href="Exercises/exercises-loops.html">Loops</a></li>
                            <li><a href="Exercises/exercises-functions.html">Functions</a></li>
                            <li><a href="Exercises/exercises-arrays.html">Arrays</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-column">
                        <h4>Resources</h4>
                        <ul>
                            <li><a href="my-notes.html">My Notes</a></li>
                            <li><a href="statistics.html">My Statistics</a></li>
                            <li><a href="contact.html">Contact</a></li>
                            <li><a href="https://ipseudoeditor.netlify.app/" target="_blank">Try Live Editor</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-column">
                        <h4>Support</h4>
                        <ul>
                            <li><a href="https://github.com/MbarkT3sto/iPseudoApp/issues">Report Issue</a></li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 iPseudo IDE by <strong>M'BARK</strong>. Free for personal & educational use.</p>
            </div>
        </div>
    </footer>

    <button class="scroll-to-top" id="scrollToTop" aria-label="Scroll to top">
        <i class="ri-arrow-up-line"></i>
    </button>

    <script src="js/script.js"></script>
    <script src="js/global-search.js"></script>
    <!-- Disabled for maximum performance -->
    <!-- <script src="js/quick-jump.js"></script> -->
    <!-- <script src="js/performance.js"></script> -->
    <!-- <script src="js/pwa-init.js"></script> -->
    <script>
        const lessons = [
            { id: '01', title: 'Introduction to Pseudocode', level: 'beginner', file: '01-introduction-to-pseudocode.html' },
            { id: '02', title: 'Getting Started with iPseudo', level: 'beginner', file: '02-getting-started.html' },
            { id: '03', title: 'Variables and Data Types', level: 'beginner', file: '03-variables-and-data-types.html' },
            { id: '04', title: 'Input and Output', level: 'beginner', file: '04-input-and-output.html' },
            { id: '05', title: 'Operators', level: 'beginner', file: '05-operators.html' },
            { id: '06', title: 'Comments and Documentation', level: 'beginner', file: '06-comments-and-documentation.html' },
            { id: '07', title: 'Conditional Statements', level: 'intermediate', file: '07-conditional-statements.html' },
            { id: '08', title: 'Loops', level: 'intermediate', file: '08-loops.html' },
            { id: '09', title: 'Nested Loops', level: 'intermediate', file: '09-nested-loops.html' },
            { id: '10', title: 'Functions', level: 'intermediate', file: '10-functions.html' },
            { id: '11', title: 'Procedures', level: 'intermediate', file: '11-procedures.html' },
            { id: '12', title: 'Arrays', level: 'intermediate', file: '12-arrays.html' },
            { id: '13', title: 'String Operations', level: 'intermediate', file: '13-string-operations.html' },
            { id: '14', title: 'Multidimensional Arrays', level: 'advanced', file: '14-multidimensional-arrays.html' },
            { id: '15', title: 'Recursion', level: 'advanced', file: '15-recursion.html' },
            { id: '16', title: 'Sorting Algorithms', level: 'advanced', file: '16-sorting-algorithms.html' },
            { id: '17', title: 'Searching Algorithms', level: 'advanced', file: '17-searching-algorithms.html' },
            { id: '18', title: 'Data Structures', level: 'advanced', file: '18-data-structures.html' },
            { id: '19', title: 'Algorithm Design Patterns', level: 'advanced', file: '19-algorithm-design-patterns.html' },
            { id: '20', title: 'Best Practices', level: 'advanced', file: '20-best-practices.html' }
        ];

        function getProgress() {
            const stored = localStorage.getItem('tutorial-progress');
            return stored ? JSON.parse(stored) : { completed: [], inProgress: [] };
        }

        function getAchievements() {
            const stored = localStorage.getItem('tutorial-achievements');
            return stored ? JSON.parse(stored) : [];
        }

        function displayStatistics() {
            const progress = getProgress();
            const achievements = getAchievements();
            const total = lessons.length;
            const completed = progress.completed.length;
            const inProgress = progress.inProgress.length;
            const percentage = Math.round((completed / total) * 100);

            // Overall Progress
            const progressIcon = percentage === 100 ? 
                'ri-vip-crown-fill' : 
                percentage >= 75 ? 
                'ri-rocket-fill' : 
                percentage >= 50 ? 
                'ri-plant-fill' : 
                percentage >= 25 ? 
                'ri-seedling-fill' : 
                'ri-book-open-fill';

            document.getElementById('overallProgress').innerHTML = `
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-xl); padding: var(--space-2xl); backdrop-filter: blur(10px); text-align: center;">
                    <i class="${progressIcon}" style="font-size: 4rem; background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: var(--space-md); display: inline-block;"></i>
                    <h2 style="font-size: 2.5rem; font-weight: 800; background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: var(--space-sm);">
                        ${percentage}% Complete
                    </h2>
                    <p style="font-size: 1.125rem; color: var(--text-secondary); margin-bottom: var(--space-xl);">
                        ${percentage === 100 ? 'Amazing! You\'ve mastered all lessons!' : `You're doing great! Keep going!`}
                    </p>
                    <div style="width: 100%; max-width: 600px; margin: 0 auto; height: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 100px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);">
                        <div style="width: ${percentage}%; height: 100%; background: linear-gradient(90deg, var(--color-purple-500), var(--color-blue-500)); border-radius: 100px; transition: width 1s ease; box-shadow: 0 2px 8px rgba(147, 51, 234, 0.4);"></div>
                    </div>
                </div>
            `;

            // Total Lessons
            document.getElementById('totalLessons').innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.08), rgba(59, 130, 246, 0.08)); border: 1px solid rgba(147, 51, 234, 0.25); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px); text-align: center; transition: all 0.3s; position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(147, 51, 234, 0.25)'; this.style.borderColor='rgba(147, 51, 234, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(147, 51, 234, 0.25)';">
                    <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, rgba(147, 51, 234, 0.15), transparent); border-radius: 50%;"></div>
                    <i class="ri-book-2-line" style="font-size: 2.5rem; color: var(--color-purple-500); margin-bottom: var(--space-sm); position: relative; z-index: 1;"></i>
                    <div style="font-size: 3rem; font-weight: 800; background: linear-gradient(135deg, var(--color-purple-500), var(--color-blue-500)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.375rem; position: relative; z-index: 1;">${total}</div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; position: relative; z-index: 1;">Total Lessons</div>
                </div>
            `;

            // Completed Lessons
            document.getElementById('completedLessons').innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.1)); border: 1px solid rgba(34, 197, 94, 0.25); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px); text-align: center; transition: all 0.3s; position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(34, 197, 94, 0.25)'; this.style.borderColor='rgba(34, 197, 94, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(34, 197, 94, 0.25)';">
                    <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, rgba(34, 197, 94, 0.15), transparent); border-radius: 50%;"></div>
                    <i class="ri-checkbox-circle-fill" style="font-size: 2.5rem; color: var(--color-success); margin-bottom: var(--space-sm); position: relative; z-index: 1;"></i>
                    <div style="font-size: 3rem; font-weight: 800; color: var(--color-success); margin-bottom: 0.375rem; position: relative; z-index: 1;">${completed}</div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; position: relative; z-index: 1;">Completed</div>
                </div>
            `;

            // In Progress
            document.getElementById('inProgressLessons').innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(234, 88, 12, 0.1), rgba(251, 146, 60, 0.1)); border: 1px solid rgba(234, 88, 12, 0.25); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px); text-align: center; transition: all 0.3s; position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(234, 88, 12, 0.25)'; this.style.borderColor='rgba(234, 88, 12, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(234, 88, 12, 0.25)';">
                    <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, rgba(234, 88, 12, 0.15), transparent); border-radius: 50%;"></div>
                    <i class="ri-time-line" style="font-size: 2.5rem; color: var(--color-orange-600); margin-bottom: var(--space-sm); position: relative; z-index: 1;"></i>
                    <div style="font-size: 3rem; font-weight: 800; color: var(--color-orange-600); margin-bottom: 0.375rem; position: relative; z-index: 1;">${inProgress}</div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; position: relative; z-index: 1;">In Progress</div>
                </div>
            `;

            // Achievements
            const totalAchievements = 15; // Total number of possible achievements
            const achievementColor = achievements.length === totalAchievements ? 'rgb(255, 215, 0)' : 'var(--color-purple-500)';
            document.getElementById('achievementsCount').innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.1), rgba(59, 130, 246, 0.1)); border: 1px solid rgba(147, 51, 234, 0.25); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px); text-align: center; transition: all 0.3s; position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(147, 51, 234, 0.25)'; this.style.borderColor='rgba(147, 51, 234, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(147, 51, 234, 0.25)';">
                    <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, rgba(147, 51, 234, 0.15), transparent); border-radius: 50%;"></div>
                    <i class="ri-trophy-fill" style="font-size: 2.5rem; color: ${achievementColor}; margin-bottom: var(--space-sm); position: relative; z-index: 1; ${achievements.length === totalAchievements ? 'filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.5));' : ''}"></i>
                    <div style="font-size: 3rem; font-weight: 800; color: ${achievementColor}; margin-bottom: 0.375rem; position: relative; z-index: 1;">${achievements.length}/${totalAchievements}</div>
                    <div style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; position: relative; z-index: 1;">Achievements</div>
                </div>
            `;

            // Level Breakdown
            const levelStats = {
                beginner: { total: 6, completed: 0 },
                intermediate: { total: 7, completed: 0 },
                advanced: { total: 7, completed: 0 }
            };

            progress.completed.forEach(id => {
                const lesson = lessons.find(l => l.id === id);
                if (lesson) levelStats[lesson.level].completed++;
            });

            displayLevelProgress('beginnerProgress', 'Beginner', levelStats.beginner, 'var(--color-success)', 'ri-seedling-line');
            displayLevelProgress('intermediateProgress', 'Intermediate', levelStats.intermediate, 'var(--color-blue-500)', 'ri-plant-line');
            displayLevelProgress('advancedProgress', 'Advanced', levelStats.advanced, 'var(--color-purple-500)', 'ri-rocket-line');

            // Achievements
            displayAchievements(achievements);

            // Recent Activity
            displayRecentActivity(progress);
        }

        function displayLevelProgress(elementId, title, stats, color, icon) {
            const percentage = Math.round((stats.completed / stats.total) * 100);
            
            document.getElementById(elementId).innerHTML = `
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px);">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-md);">
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div style="width: 56px; height: 56px; background: linear-gradient(135deg, ${color}22, ${color}11); border: 2px solid ${color}44; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;">
                                <div style="position: absolute; inset: 0; background: radial-gradient(circle at 30% 30%, ${color}33, transparent); opacity: 0.5;"></div>
                                <i class="${icon}" style="font-size: 1.75rem; color: ${color}; position: relative; z-index: 1;"></i>
                            </div>
                            <div>
                                <div style="font-size: 1.125rem; font-weight: 700; color: var(--text-primary);">${title}</div>
                                <div style="font-size: 0.875rem; color: var(--text-secondary);">${stats.completed}/${stats.total} lessons</div>
                            </div>
                        </div>
                        <div style="font-size: 1.5rem; font-weight: 800; color: ${color};">${percentage}%</div>
                    </div>
                    <div style="width: 100%; height: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 100px; overflow: hidden;">
                        <div style="width: ${percentage}%; height: 100%; background: ${color}; border-radius: 100px; transition: width 1s ease;"></div>
                    </div>
                </div>
            `;
        }

        function displayAchievements(achievements) {
            const goldColor = 'rgb(234, 179, 8)'; // Golden color for all achievements
            
            const allAchievements = [
                // Milestone Achievements
                { id: 'first-steps', title: 'First Steps', icon: 'ri-medal-2-fill', color: goldColor, description: 'Complete your first lesson', category: 'Milestone', unlocked: achievements.includes('first-steps') },
                { id: 'quick-learner', title: 'Quick Learner', icon: 'ri-thunderstorms-fill', color: goldColor, description: 'Complete 5 lessons', category: 'Milestone', unlocked: achievements.includes('quick-learner') },
                { id: 'dedicated-student', title: 'Dedicated Student', icon: 'ri-book-mark-fill', color: goldColor, description: 'Complete 10 lessons', category: 'Milestone', unlocked: achievements.includes('dedicated-student') },
                { id: 'knowledge-seeker', title: 'Knowledge Seeker', icon: 'ri-compass-3-fill', color: goldColor, description: 'Complete 15 lessons', category: 'Milestone', unlocked: achievements.includes('knowledge-seeker') },
                
                // Level-Based Achievements
                { id: 'beginner-master', title: 'Beginner Master', icon: 'ri-award-fill', color: goldColor, description: 'Complete all beginner lessons', category: 'Mastery', unlocked: achievements.includes('beginner-master') },
                { id: 'intermediate-expert', title: 'Intermediate Expert', icon: 'ri-medal-fill', color: goldColor, description: 'Complete all intermediate lessons', category: 'Mastery', unlocked: achievements.includes('intermediate-expert') },
                { id: 'advanced-guru', title: 'Advanced Guru', icon: 'ri-trophy-fill', color: goldColor, description: 'Complete all advanced lessons', category: 'Mastery', unlocked: achievements.includes('advanced-guru') },
                { id: 'complete-master', title: 'iPseudo Master', icon: 'ri-vip-crown-2-fill', color: goldColor, description: 'Complete ALL 20 lessons!', category: 'Mastery', unlocked: achievements.includes('complete-master') },
                
                // Time-Based Achievements
                { id: 'productive-day', title: 'Productive Day', icon: 'ri-flashlight-fill', color: goldColor, description: 'Complete 3 lessons in one day', category: 'Activity', unlocked: achievements.includes('productive-day') },
                { id: 'early-bird', title: 'Early Bird', icon: 'ri-contrast-drop-2-fill', color: goldColor, description: 'Complete a lesson in the morning', category: 'Activity', unlocked: achievements.includes('early-bird') },
                { id: 'night-owl', title: 'Night Owl', icon: 'ri-star-smile-fill', color: goldColor, description: 'Complete a lesson late at night', category: 'Activity', unlocked: achievements.includes('night-owl') },
                { id: 'week-warrior', title: 'Week Warrior', icon: 'ri-knife-blood-fill', color: goldColor, description: '7-day study streak!', category: 'Activity', unlocked: achievements.includes('week-warrior') },
                { id: 'speed-learner', title: 'Speed Learner', icon: 'ri-flight-takeoff-fill', color: goldColor, description: 'Complete 5 lessons in one week', category: 'Activity', unlocked: achievements.includes('speed-learner') },
                
                // Engagement Achievements
                { id: 'note-taker', title: 'Note Taker', icon: 'ri-pen-nib-fill', color: goldColor, description: 'Save notes on 5 lessons', category: 'Engagement', unlocked: achievements.includes('note-taker') },
                { id: 'curious-mind', title: 'Curious Mind', icon: 'ri-brain-fill', color: goldColor, description: 'Explore all lesson pages', category: 'Engagement', unlocked: achievements.includes('curious-mind') }
            ];

            const unlockedCount = allAchievements.filter(a => a.unlocked).length;
            
            let achievementsHTML = `
                <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-lg); text-align: center;">
                    <i class="ri-trophy-line" style="color: var(--color-purple-500);"></i>
                    Achievements Gallery (${unlockedCount}/${allAchievements.length})
                </h2>
            `;
            
            // Group by category
            const categories = ['Milestone', 'Mastery', 'Activity', 'Engagement'];
            const categoryIcons = {
                'Milestone': 'ri-flag-line',
                'Mastery': 'ri-medal-line',
                'Activity': 'ri-flashlight-line',
                'Engagement': 'ri-heart-line'
            };
            
            categories.forEach(category => {
                const categoryAchievements = allAchievements.filter(a => a.category === category);
                const categoryUnlocked = categoryAchievements.filter(a => a.unlocked).length;
                
                achievementsHTML += `
                    <div style="margin-bottom: var(--space-xl);">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: var(--space-md);">
                            <i class="${categoryIcons[category]}" style="color: var(--color-purple-500); font-size: 1.25rem;"></i>
                            <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary);">${category}</h3>
                            <span style="font-size: 0.875rem; color: var(--text-secondary); margin-left: auto;">${categoryUnlocked}/${categoryAchievements.length}</span>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: var(--space-md);">
                `;
                
                categoryAchievements.forEach(achievement => {
                    achievementsHTML += `
                        <div style="background: var(--glass-bg); border: 1px solid ${achievement.unlocked ? achievement.color + '66' : 'var(--glass-border)'}; border-radius: var(--radius-lg); padding: var(--space-lg); backdrop-filter: blur(10px); text-align: center; ${achievement.unlocked ? '' : 'opacity: 0.5;'} transition: all 0.3s; position: relative; overflow: hidden;" ${achievement.unlocked ? `onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px ${achievement.color}33';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';"` : ''}>
                            ${achievement.unlocked ? `<div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, ${achievement.color}22, transparent); pointer-events: none;"></div>` : ''}
                            <div style="width: 64px; height: 64px; margin: 0 auto var(--space-sm); background: ${achievement.unlocked ? 'linear-gradient(135deg, ' + achievement.color + '22, ' + achievement.color + '11)' : 'rgba(255, 255, 255, 0.05)'}; border: 2px solid ${achievement.unlocked ? achievement.color + '44' : 'var(--glass-border)'}; border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative; z-index: 1; ${achievement.unlocked ? '' : 'filter: grayscale(100%);'}">
                                <i class="${achievement.icon}" style="font-size: 2rem; color: ${achievement.unlocked ? achievement.color : 'var(--text-tertiary)'};"></i>
                            </div>
                            <div style="font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.5rem; position: relative; z-index: 1;">${achievement.title}</div>
                            <div style="font-size: 0.8125rem; color: var(--text-secondary); position: relative; z-index: 1;">${achievement.description}</div>
                            ${achievement.unlocked ? `<div style="margin-top: var(--space-sm); font-size: 0.75rem; color: ${achievement.color}; font-weight: 600; position: relative; z-index: 1;"><i class="ri-check-line"></i> Unlocked!</div>` : '<div style="margin-top: var(--space-sm); font-size: 0.75rem; color: var(--text-tertiary); position: relative; z-index: 1;"><i class="ri-lock-fill"></i> Locked</div>'}
                        </div>
                    `;
                });
                
                achievementsHTML += '</div></div>';
            });
            
            document.getElementById('achievementsSection').innerHTML = achievementsHTML;
        }

        function displayRecentActivity(progress) {
            const recentCompleted = progress.completed.slice(-5).reverse();
            const recentInProgress = progress.inProgress.slice(-5).reverse();

            if (recentCompleted.length === 0 && recentInProgress.length === 0) {
                document.getElementById('recentActivity').innerHTML = '';
                return;
            }

            let activityHTML = `
                <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-lg); text-align: center;">
                    <i class="ri-history-line" style="color: var(--color-purple-500);"></i>
                    Recent Activity
                </h2>
                <div style="background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-lg); padding: var(--space-xl); backdrop-filter: blur(10px);">
            `;

            if (recentCompleted.length > 0) {
                activityHTML += `<div style="margin-bottom: ${recentInProgress.length > 0 ? 'var(--space-lg)' : '0'};">`;
                activityHTML += `<div style="font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 0.5rem;"><i class="ri-checkbox-circle-fill" style="color: var(--color-success);"></i> Recently Completed</div>`;
                
                recentCompleted.forEach(id => {
                    const lesson = lessons.find(l => l.id === id);
                    if (lesson) {
                        activityHTML += `
                            <a href="${lesson.file}" style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-sm); margin-bottom: 0.5rem; border-radius: var(--radius-sm); text-decoration: none; transition: all 0.2s;" onmouseover="this.style.background='rgba(34, 197, 94, 0.1)';" onmouseout="this.style.background='transparent';">
                                <div style="width: 32px; height: 32px; background: var(--color-success); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 0.75rem;">${lesson.id}</div>
                                <div style="flex: 1; color: var(--text-primary); font-weight: 500;">${lesson.title}</div>
                                <i class="ri-arrow-right-line" style="color: var(--text-tertiary);"></i>
                            </a>
                        `;
                    }
                });
                activityHTML += '</div>';
            }

            if (recentInProgress.length > 0) {
                activityHTML += '<div>';
                activityHTML += `<div style="font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-md); display: flex; align-items: center; gap: 0.5rem;"><i class="ri-time-line" style="color: var(--color-orange-600);"></i> Currently Reading</div>`;
                
                recentInProgress.forEach(id => {
                    const lesson = lessons.find(l => l.id === id);
                    if (lesson) {
                        activityHTML += `
                            <a href="${lesson.file}" style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-sm); margin-bottom: 0.5rem; border-radius: var(--radius-sm); text-decoration: none; transition: all 0.2s;" onmouseover="this.style.background='rgba(234, 88, 12, 0.1)';" onmouseout="this.style.background='transparent';">
                                <div style="width: 32px; height: 32px; background: var(--color-orange-600); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 0.75rem;">${lesson.id}</div>
                                <div style="flex: 1; color: var(--text-primary); font-weight: 500;">${lesson.title}</div>
                                <i class="ri-arrow-right-line" style="color: var(--text-tertiary);"></i>
                            </a>
                        `;
                    }
                });
                activityHTML += '</div>';
            }

            activityHTML += '</div>';
            document.getElementById('recentActivity').innerHTML = activityHTML;
        }

        // Chart configuration for dark mode
        function getChartColors() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark' || !document.documentElement.hasAttribute('data-theme');
            return {
                text: isDark ? '#e5e7eb' : '#1f2937',
                grid: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)',
                purple: 'rgb(147, 51, 234)',
                blue: 'rgb(59, 130, 246)',
                green: 'rgb(34, 197, 94)',
                orange: 'rgb(234, 88, 12)',
                red: 'rgb(239, 68, 68)'
            };
        }

        function createProgressChart() {
            const progress = getProgress();
            const timestamps = JSON.parse(localStorage.getItem('lesson-timestamps') || '{}');
            
            // Get completion dates
            const completionDates = {};
            progress.completed.forEach(lessonId => {
                const timestamp = timestamps[lessonId] || Date.now();
                const date = new Date(timestamp).toLocaleDateString();
                completionDates[date] = (completionDates[date] || 0) + 1;
            });

            // Generate last 30 days
            const dates = [];
            const counts = [];
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString();
                dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                
                let cumulative = 0;
                Object.keys(completionDates).forEach(d => {
                    if (new Date(d) <= date) {
                        cumulative += completionDates[d];
                    }
                });
                counts.push(cumulative);
            }

            const colors = getChartColors();
            const ctx = document.getElementById('progressChart');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Lessons Completed',
                        data: counts,
                        borderColor: colors.purple,
                        backgroundColor: `${colors.purple}33`,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: colors.purple,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: colors.text,
                                stepSize: 1
                            },
                            grid: {
                                color: colors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: colors.text,
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: colors.grid
                            }
                        }
                    }
                }
            });
        }

        function createCategoryChart() {
            const progress = getProgress();
            const levelStats = {
                beginner: { total: 6, completed: 0 },
                intermediate: { total: 7, completed: 0 },
                advanced: { total: 7, completed: 0 }
            };

            progress.completed.forEach(id => {
                const lesson = lessons.find(l => l.id === id);
                if (lesson) levelStats[lesson.level].completed++;
            });

            const colors = getChartColors();
            const ctx = document.getElementById('categoryChart');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Beginner', 'Intermediate', 'Advanced'],
                    datasets: [{
                        data: [
                            levelStats.beginner.completed,
                            levelStats.intermediate.completed,
                            levelStats.advanced.completed
                        ],
                        backgroundColor: [
                            colors.green,
                            colors.blue,
                            colors.purple
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: colors.text,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        function createWeeklyChart() {
            const progress = getProgress();
            const timestamps = JSON.parse(localStorage.getItem('lesson-timestamps') || '{}');
            
            // Get last 7 days
            const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const today = new Date();
            const labels = [];
            const data = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                labels.push(weekDays[date.getDay()]);
                
                const dateStr = date.toLocaleDateString();
                let count = 0;
                
                progress.completed.forEach(lessonId => {
                    const timestamp = timestamps[lessonId];
                    if (timestamp) {
                        const lessonDate = new Date(timestamp).toLocaleDateString();
                        if (lessonDate === dateStr) count++;
                    }
                });
                
                data.push(count);
            }

            const colors = getChartColors();
            const ctx = document.getElementById('weeklyChart');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Lessons Completed',
                        data: data,
                        backgroundColor: colors.green,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: colors.text,
                                stepSize: 1
                            },
                            grid: {
                                color: colors.grid
                            }
                        },
                        x: {
                            ticks: {
                                color: colors.text
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        function displayStudyInsights() {
            const progress = getProgress();
            const timestamps = JSON.parse(localStorage.getItem('lesson-timestamps') || '{}');
            const completed = progress.completed.length;
            const remaining = lessons.length - completed;
            
            // Calculate average lessons per week
            const sortedTimestamps = progress.completed
                .map(id => timestamps[id] || Date.now())
                .sort((a, b) => a - b);
            
            let avgPerWeek = 0;
            let studyStreak = 0;
            let estimatedWeeks = 0;
            
            if (sortedTimestamps.length > 0) {
                const firstDate = new Date(sortedTimestamps[0]);
                const lastDate = new Date(sortedTimestamps[sortedTimestamps.length - 1]);
                const weeksPassed = Math.max(1, (lastDate - firstDate) / (1000 * 60 * 60 * 24 * 7));
                avgPerWeek = (completed / weeksPassed).toFixed(1);
                
                if (avgPerWeek > 0) {
                    estimatedWeeks = Math.ceil(remaining / avgPerWeek);
                }
                
                // Calculate streak
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                let checkDate = new Date(today);
                
                while (true) {
                    const dateStr = checkDate.toLocaleDateString();
                    const hasActivity = progress.completed.some(id => {
                        const ts = timestamps[id];
                        if (ts) {
                            const lessonDate = new Date(ts);
                            lessonDate.setHours(0, 0, 0, 0);
                            return lessonDate.toLocaleDateString() === dateStr;
                        }
                        return false;
                    });
                    
                    if (hasActivity) {
                        studyStreak++;
                        checkDate.setDate(checkDate.getDate() - 1);
                    } else {
                        break;
                    }
                }
            }
            
            const colors = getChartColors();
            const insightsHTML = `
                <div style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md); background: rgba(147, 51, 234, 0.1); border-radius: var(--radius-lg);">
                    <div style="width: 48px; height: 48px; background: ${colors.purple}; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-speed-line" style="font-size: 1.5rem; color: white;"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Average Pace</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary);">${avgPerWeek || '—'} lessons/week</div>
                    </div>
                </div>
                
                <div style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md); background: rgba(34, 197, 94, 0.1); border-radius: var(--radius-lg);">
                    <div style="width: 48px; height: 48px; background: ${colors.green}; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-fire-line" style="font-size: 1.5rem; color: white;"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Study Streak</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary);">${studyStreak} day${studyStreak !== 1 ? 's' : ''}</div>
                    </div>
                </div>
                
                ${remaining > 0 && avgPerWeek > 0 ? `
                <div style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md); background: rgba(59, 130, 246, 0.1); border-radius: var(--radius-lg);">
                    <div style="width: 48px; height: 48px; background: ${colors.blue}; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-calendar-check-line" style="font-size: 1.5rem; color: white;"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Estimated Completion</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary);">${estimatedWeeks} week${estimatedWeeks !== 1 ? 's' : ''}</div>
                    </div>
                </div>
                ` : `
                <div style="display: flex; align-items: center; gap: var(--space-md); padding: var(--space-md); background: rgba(255, 215, 0, 0.1); border-radius: var(--radius-lg);">
                    <div style="width: 48px; height: 48px; background: rgb(255, 215, 0); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ri-trophy-fill" style="font-size: 1.5rem; color: white;"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Status</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--text-primary);">All Complete! 🎉</div>
                    </div>
                </div>
                `}
            `;
            
            document.getElementById('studyInsights').innerHTML = insightsHTML;
        }

        // Initialize timestamp tracking
        function initTimestampTracking() {
            const timestamps = JSON.parse(localStorage.getItem('lesson-timestamps') || '{}');
            const progress = getProgress();
            
            // Add timestamps for lessons that don't have them
            progress.completed.forEach(lessonId => {
                if (!timestamps[lessonId]) {
                    timestamps[lessonId] = Date.now();
                }
            });
            
            localStorage.setItem('lesson-timestamps', JSON.stringify(timestamps));
        }

        // Display statistics on load
        initTimestampTracking();
        displayStatistics();
        createProgressChart();
        createCategoryChart();
        createWeeklyChart();
        displayStudyInsights();
    </script>
</body>
</html>

