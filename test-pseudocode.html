<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pseudocode Language Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 80vh;
        }
        .editor-panel, .output-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        .output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a9e;
        }
        .controls {
            margin-bottom: 10px;
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>üß™ iPseudo Language Test Suite</h1>
    <p>Test all pseudocode language features with this interactive demo.</p>
    
    <div class="container">
        <div class="editor-panel">
            <h2>üìù Pseudocode Editor</h2>
            <div class="controls">
                <button onclick="loadSample()">Load Sample</button>
                <button onclick="clearEditor()">Clear</button>
                <button onclick="runCode()">‚ñ∂Ô∏è Run</button>
                <button onclick="stopExecution()">‚èπÔ∏è Stop</button>
            </div>
            <textarea id="editor" placeholder="Enter your pseudocode here..."># Welcome to iPseudo Language Test
# Try running this sample code

var name = "World"
print "Hello " + name

for i = 1 to 5
    print "Count: " + i
endfor

if 5 > 3 then
    print "Math works!"
endif</textarea>
        </div>
        
        <div class="output-panel">
            <h2>üìä Output Console</h2>
            <div class="output" id="output">Ready to run pseudocode... Click "Run" to execute your code.</div>
        </div>
    </div>

    <script>
        let isRunning = false;
        let worker = null;

        function loadSample() {
            const sampleCode = `# iPseudo Language Test Suite
# This demonstrates all supported features

# Variables and Constants
var age = 20
var name = "Alice"
const PI = 3.14

# Print statements
print "Hello World"
print age
print "Name is:"
print name

# Conditional statements
var score = 75

if score >= 90 then
    print "Excellent"
elseif score >= 60 then
    print "Good"
else
    print "Fail"
endif

# For loops
print "Counting from 1 to 5:"
for i = 1 to 5
    print i
endfor

# While loops
var x = 1
print "While loop example:"
while x <= 5
    print x
    x = x + 1
endwhile

# Functions
function addNumbers(a, b)
    var result = a + b
    return result
endfunction

var sum = addNumbers(5, 10)
print "Sum is:"
print sum

print "Done!"`;
            
            document.getElementById('editor').value = sampleCode;
        }

        function clearEditor() {
            document.getElementById('editor').value = '';
            document.getElementById('output').textContent = 'Ready to run pseudocode... Click "Run" to execute your code.';
        }

        function runCode() {
            if (isRunning) return;
            
            const code = document.getElementById('editor').value;
            if (!code.trim()) {
                addOutput('‚ùå No code to run!');
                return;
            }

            isRunning = true;
            document.getElementById('output').textContent = 'üîÑ Running pseudocode...\n\n';
            
            // Create a simple worker simulation
            try {
                // Simulate the worker functionality
                const result = simulatePseudocodeExecution(code);
                addOutput(result);
            } catch (error) {
                addOutput('‚ùå Error: ' + error.message);
            }
            
            isRunning = false;
        }

        function stopExecution() {
            if (isRunning) {
                isRunning = false;
                addOutput('\n‚èπÔ∏è Execution stopped by user.');
            }
        }

        function addOutput(text) {
            const output = document.getElementById('output');
            output.textContent += text + '\n';
            output.scrollTop = output.scrollHeight;
        }

        function simulatePseudocodeExecution(code) {
            // This is a simplified simulation for demonstration
            // In the real app, this would use the actual worker
            
            const lines = code.split('\n');
            let output = '';
            let variables = {};
            let functions = {};
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line || line.startsWith('#')) continue;
                
                // Variable declarations
                if (line.startsWith('var ') || line.startsWith('const ')) {
                    const match = line.match(/^(var|const)\s+([a-zA-Z_$][\w$]*)\s*=\s*(.*)$/i);
                    if (match) {
                        const [, keyword, varName, value] = match;
                        variables[varName] = eval(value);
                        output += `‚úì Declared ${keyword} ${varName} = ${variables[varName]}\n`;
                    }
                }
                // Print statements
                else if (line.startsWith('print ')) {
                    const match = line.match(/^print\s+(.+)$/i);
                    if (match) {
                        const expression = match[1];
                        let value;
                        try {
                            value = eval(expression.replace(/\b([a-zA-Z_$][\w$]*)\b/g, (match) => {
                                return variables[match] !== undefined ? variables[match] : match;
                            }));
                        } catch (e) {
                            value = expression;
                        }
                        output += `üìù ${value}\n`;
                    }
                }
                // For loops
                else if (line.startsWith('for ')) {
                    const match = line.match(/^for\s+([a-zA-Z_$][\w$]*)\s*=\s*(.+?)\s+to\s+(.+?)(?:\s+step\s+([-+]?\d+))?\s*$/i);
                    if (match) {
                        const [, varName, start, end, step = '1'] = match;
                        const startVal = parseInt(start);
                        const endVal = parseInt(end);
                        const stepVal = parseInt(step);
                        
                        for (let j = startVal; j <= endVal; j += stepVal) {
                            variables[varName] = j;
                            output += `üìù ${j}\n`;
                        }
                    }
                }
                // While loops
                else if (line.startsWith('while ')) {
                    const match = line.match(/^while\s+(.+?)(?:\s+then)?\s*$/i);
                    if (match) {
                        const condition = match[1];
                        // Simplified while loop simulation
                        output += `üîÑ While loop: ${condition}\n`;
                    }
                }
                // If statements
                else if (line.startsWith('if ')) {
                    const match = line.match(/^if\s+(.+?)(?:\s+then)?\s*$/i);
                    if (match) {
                        const condition = match[1];
                        output += `üîç If condition: ${condition}\n`;
                    }
                }
                // Function declarations
                else if (line.startsWith('function ')) {
                    const match = line.match(/^function\s+([a-zA-Z_$][\w$]*)\s*\(([^)]*)\)\s*$/i);
                    if (match) {
                        const [, funcName, params] = match;
                        functions[funcName] = { params: params.split(',').map(p => p.trim()) };
                        output += `üîß Function declared: ${funcName}(${params})\n`;
                    }
                }
                // Assignment
                else if (line.includes('=') && !line.includes('==') && !line.includes('!=')) {
                    const match = line.match(/^([a-zA-Z_$][\w$]*)\s*=\s*(.+)$/);
                    if (match) {
                        const [, varName, value] = match;
                        variables[varName] = eval(value.replace(/\b([a-zA-Z_$][\w$]*)\b/g, (match) => {
                            return variables[match] !== undefined ? variables[match] : match;
                        }));
                        output += `‚úì Assigned ${varName} = ${variables[varName]}\n`;
                    }
                }
            }
            
            return output + '\n‚úÖ Execution completed successfully!';
        }

        // Load sample on page load
        window.onload = function() {
            loadSample();
        };
    </script>
</body>
</html>
