<!DOCTYPE html>
<html lang="en" class="theme-transition theme-dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Confirmation Modal - iPseudo IDE</title>
    
    <!-- Local Fonts -->
    <link rel="stylesheet" href="fonts/google/inter.css">
    <link rel="stylesheet" href="fonts/google/jetbrains-mono.css">
    <link rel="stylesheet" href="fonts/google/fira-code.css">
    <link rel="stylesheet" href="fonts/google/poppins.css">
    
    <!-- Local Icons -->
    <link rel="stylesheet" href="fonts/remixicon/remixicon.css">
    
    <!-- Modern Styles -->
    <link rel="stylesheet" href="styles/modern-design-tokens.css">
    <link rel="stylesheet" href="styles/modern-base.css">
    <link rel="stylesheet" href="styles/modern-components.css">
    <link rel="stylesheet" href="styles/modern-layout.css">
    <link rel="stylesheet" href="styles/modern-theme.css">
    <link rel="stylesheet" href="styles/modern-tab-system.css">
    <link rel="stylesheet" href="styles/performance.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            padding: 2rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .test-container {
            text-align: center;
            max-width: 600px;
        }
        
        .test-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .test-description {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }
        
        .test-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .theme-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">Confirmation Modal Test</h1>
        <p class="test-description">Test the enhanced confirmation modals with smooth animations and modern styling</p>
        
        <div class="test-buttons">
            <button class="modern-btn modern-btn-primary" onclick="testCloseTab()">
                <i class="ri-close-circle-line"></i>
                Test Close Tab
            </button>
            
            <button class="modern-btn modern-btn-danger" onclick="testDeleteFile()">
                <i class="ri-delete-bin-line"></i>
                Test Delete File
            </button>
            
            <button class="modern-btn modern-btn-warning" onclick="testSaveChanges()">
                <i class="ri-save-line"></i>
                Test Save Changes
            </button>
        </div>
        
        <button class="modern-btn modern-btn-secondary theme-toggle" id="themeToggle">
            <i class="ri-contrast-2-line"></i>
            Toggle Theme
        </button>
    </div>
    
    <script>
        // Theme toggle functionality
        document.getElementById('themeToggle').addEventListener('click', function() {
            const html = document.documentElement;
            const isDark = html.classList.contains('theme-dark');
            
            if (isDark) {
                html.classList.remove('theme-dark');
                html.classList.add('theme-light');
            } else {
                html.classList.remove('theme-light');
                html.classList.add('theme-dark');
            }
        });
        
        // Enhanced confirmation modal function (copied from app.js)
        function showConfirmationModal(title, message, buttons) {
            // Remove any existing modal
            const existingModal = document.querySelector('.confirmation-modal-overlay');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Create modal overlay
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'confirmation-modal-overlay';
            
            // Create modal content
            const modal = document.createElement('div');
            modal.className = 'confirmation-modal';
            modal.innerHTML = `
                <h3>${title}</h3>
                <p>${message}</p>
                <div class="confirmation-buttons">
                    ${buttons.map((btn, index) => `
                        <button class="confirmation-btn ${btn.primary ? 'primary' : 'secondary'}" data-action="${index}">${btn.text}</button>
                    `).join('')}
                </div>
            `;
            
            modalOverlay.appendChild(modal);
            document.body.appendChild(modalOverlay);
            
            // Show modal with animation
            setTimeout(() => {
                modalOverlay.classList.add('show');
            }, 10);
            
            // Add event listeners
            modal.addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('confirmation-btn')) {
                    const actionIndex = parseInt(target.dataset.action || '0');
                    buttons[actionIndex].action();
                    closeConfirmationModal(modalOverlay);
                }
            });
            
            // Close on overlay click
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    closeConfirmationModal(modalOverlay);
                }
            });
            
            // Focus first button
            const firstButton = modal.querySelector('.confirmation-btn');
            if (firstButton) {
                firstButton.focus();
            }
            
            // Close on Escape key
            const handleEscape = function(e) {
                if (e.key === 'Escape') {
                    closeConfirmationModal(modalOverlay);
                    document.removeEventListener('keydown', handleEscape);
                }
            };
            document.addEventListener('keydown', handleEscape);
        }
        
        // Function to close confirmation modal with animation
        function closeConfirmationModal(modalOverlay) {
            modalOverlay.classList.remove('show');
            setTimeout(() => {
                if (modalOverlay.parentNode) {
                    modalOverlay.parentNode.removeChild(modalOverlay);
                }
            }, 300);
        }
        
        // Test functions
        function testCloseTab() {
            showConfirmationModal(
                'Close Tab',
                'You have unsaved changes. Are you sure you want to close this tab?',
                [
                    { text: 'Keep Open', primary: false, action: () => console.log('Tab kept open') },
                    { text: 'Close Anyway', primary: true, action: () => console.log('Tab closed') }
                ]
            );
        }
        
        function testDeleteFile() {
            showConfirmationModal(
                'Delete File',
                'Are you sure you want to delete this file? This action cannot be undone.',
                [
                    { text: 'Cancel', primary: false, action: () => console.log('Delete cancelled') },
                    { text: 'Delete', primary: true, action: () => console.log('File deleted') }
                ]
            );
        }
        
        function testSaveChanges() {
            showConfirmationModal(
                'Save Changes',
                'Do you want to save your changes before continuing?',
                [
                    { text: "Don't Save", primary: false, action: () => console.log('Changes not saved') },
                    { text: 'Save', primary: true, action: () => console.log('Changes saved') }
                ]
            );
        }
    </script>
</body>
</html>
